# [ORACLE] ORA-01861 literal does not match format string 해결



## 문제 개요

`ORA-01861 literal does not match format string` 에러의 경우,  현재의 날짜 형식을 지정하는 파라미터와 다른 형식의 문자열로 날짜 변환을 시도할 때 발생한다.

TO_DATE 함수에서 날짜 포맷을 잘 못 지정하여 발생하기도 하지만, DATE 타입의 컬럼에 String 형식으로 데이터를 넣거나, TO_DATE에서 별도의 날짜 형식을 집어넣지 않을 경우에도 종종 발생한다.

예를 들어, 현재의 디폴트 날짜 형식이 'RR/MM/DD'로 되어있는데,  '20230621120000'와 같은 문자열을 DATE 타입 컬럼에 넣거나, `TO_DATE('20230621120000')`를 시도할 때 발생한다.



## 해결 방법

주로 사용하는 해결 방법으로는 다음 3가지가 있다.



### 1. TO_DATE에서 현재 문자열 형식에 맞는 포맷 지정

`TO_DATE('20230621120000', 'YYYYMMDDHH24MISS')`와 같이 현재 문자열에 맞는 날짜 포맷을 날짜 변환 함수에서 지정하는 방식이다.

각각의 날짜 문자열에 맞는 포맷을 설정하며 보편적으로 사용할 수 있지만, 매번 날짜 포맷을 수작업으로 지정해야 한다는 단점이 있다.



### 2. 현재 세션의 디폴트 날짜 포맷 변환

우선 현재의 디폴트 문자열 형식은 다음 쿼리를 통해서 확인할 수 있다.

```SQL
SELECT value FROM nls_session_parameters WHERE parameter = 'NLS_DATE_FORMAT';
```



여기서 조회되는 문자열 형식이 내가 현재 세션동안 주로 사용할 날짜 문자열과 맞지 않는다면, 다음 쿼리를 통해서 변경이 가능하다.

```SQL
ALTER SESSION SET NLS_DATE_FORMAT = 'YYYYMMDDHH24MISS'
```



이렇게 세션의 디폴트 문자열 포맷을 변경해주면, '20230621120000' 문자열을 날짜 타입의 컬럼에 넣거나, `TO_DATE('20230621120000')`와 같이 TO_DATE 함수에서 문자열 포맷을 지정하지 않아도 된다.



### 3. 데이터베이스 수준에서 디폴트 날짜 포맷 변환

현재의 세션 뿐만 아니라 모든 세션에서의 디폴트 문자열 포맷을 변환하고 싶다면 다음과 같은 쿼리를 사용한다.

```SQL
ALTER SYSTEM SET NLS_DATE_FORMAT = 'YYYY-MM-DD' SCOPE=SPFILE;
```

데이터베이스 수준에서 NLS_DATE_FORMAT을 변경하려면 DBA 권한이 필요하다. 해당 쿼리는 SPFILE에 설정을 저장하고, 데이터베이스가 재시작될 때 영구적으로 적용한다.


